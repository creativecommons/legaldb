{% extends 'legal_db/base.html' %}
{% load i18n static %}

{% block body_content %}

<section class="hero case">
  <div class="container">
    {% include "legal_db/partials/_breadcrumb.html" %}
    <h1 class="hero-title title is-2">{% trans "Cases" %}</h1>
    <div class="case-holder">
      <div class="contribute-card">
        <article class="card entry-post link no-border">
          <a href="{% url 'case_submit' %}" class="has-background-tomato">
            <span class="card-content has-bottom-link">
              <h2 class="card-title">{% trans "Contribute" %}</h2>
              <span class="content">{% trans "Do you want to submit a legal dispute to the database?" %}</span>
              <strong class="link-arrow">{% trans "Submit a case" %} <i class="icon chevron-right"></i></strong>
            </span>
          </a>
        </article>
      </div>
      <p class="hero-description body-big">
        {% blocktrans trimmed %}
          Here you will find information on litigation that involves or directly affects Creative Commons legal tools. Click on the link to each case name for more details on the dispute.
        {% endblocktrans %}
      </p>
    </div>
  </div>
</section>

<section class="cases">
  <div class="container">
    <form id="search" role="search" method="get">
      {% include "legal_db/partials/_search.html" %}

      <div id="tags" aria-expanded="true">
      {% for tag in tags %}
        <label for="tag-check-{{ forloop.counter }}" id="tag-label-{{ forloop.counter }}"
               class="button tag case margin-right-small margin-vertical-smaller{% if tag.checked %} selected{% endif %}"
               role="checkbox" aria-checked="{% if tag.checked %}true{% else %}false{% endif %}"
               >
          {{ tag.name }}
          <input type="checkbox" class="tag__check" name="tags[]"
                 id="tag-check-{{ forloop.counter }}"
                 value="{{ tag.name }}"
                 {% if tag.checked %} checked{% endif %}
                 hidden>
        </label>
      {% endfor %}
      </div>
    </form>

    <div class="margin-vertical-big table-container">
      <table class="table is-bordered is-striped is-fullwidth">
        <thead>
          <tr>
            <th>
              <a href="?sort=country&direction={% if direction == 'desc' %}asc{% else %}desc{% endif %}{% if request.GET.keywords %}&keywords={{ request.GET.keywords }}{% endif %}">
                {% trans "Country" %}
              </a>
            </th>
            <th>
              <a href="?sort=name&direction={% if direction == 'desc' %}asc{% else %}desc{% endif %}{% if request.GET.keywords %}&keywords={{ request.GET.keywords }}{% endif %}">
                {% trans "Case name" %}
              </a>
            </th>
            <th>{% trans "License" %}</th>
            <th>
              <a href="?sort=decision_year&direction={% if direction == 'desc' %}asc{% else %}desc{% endif %}{% if request.GET.keywords %}&keywords={{ request.GET.keywords }}{% endif %}">
                {% trans "Year of resolution" %}
              </a>
            </th>
          </tr>
        </thead>
        <tbody>
        {% for case in cases %}
          <tr>
            <td>{{ case.country.name }}</td>
            <td><a href="{% url 'case_detail' case.id %}" class="has-text-dark-slate-blue">{{ case.name }}</a></td>
            <td class="is-narrow">
              {% if not case.license %} <span class="has-text-grey">{% trans "Unknown" %}</span>
              {% else %} {{ case.license }} {% endif %}
            </td>
            <td class="number-cell">{{ case.decision_year|default:"" }}</td>
          </tr>
        {% empty %}
          <tr><td class="has-text-centered" colspan="4">{% trans "No cases are available. Try different filters or search terms." %}</td></tr>
        {% endfor %}
        </tbody>
      </table>
    </div>

    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
      <ul class="pagination-list">
        {% if page_obj.has_previous %}
          <li>
            <a class="pagination-link button tag case margin-right-small margin-vertical-smaller" href="?page=1&sort={{ current_sort }}&direction={{ direction }}">&laquo; First</a>
          </li>
          <li>
            <a class="pagination-link button tag case margin-right-small margin-vertical-smaller" href="?page={{ page_obj.previous_page_number }}&sort={{ current_sort }}&direction={{ direction }}">Previous</a>
          </li>
        {% endif %}
    
        {% for page in custom_page_range %}
          {% if page == "..." %}
            <li><span class="pagination-ellipsis">&hellip;</span></li>
          {% elif page == page_obj.number %}
            <li>
              <a class="pagination-link is-current button tag margin-right-small margin-vertical-smaller">{{ page }}</a>
            </li>
          {% else %}
            <li>
              <a class="pagination-link button tag case margin-right-small margin-vertical-smaller" href="?page={{ page }}&sort={{ current_sort }}&direction={{ direction }}">{{ page }}</a>
            </li>
          {% endif %}
        {% endfor %}
    
        {% if page_obj.has_next %}
          <li>
            <a class="pagination-link button tag case margin-right-small margin-vertical-smaller" href="?page={{ page_obj.next_page_number }}&sort={{ current_sort }}&direction={{ direction }}">Next</a>
          </li>
          <li>
            <a class="pagination-link button tag case margin-right-small margin-vertical-smaller" href="?page={{ page_obj.paginator.num_pages }}&sort={{ current_sort }}&direction={{ direction }}">Last &raquo;</a>
          </li>
        {% endif %}
      </ul>
    </nav>
    
  </div>
</section>
{% endblock %}

{% block js_content %}
  <script src="{% static 'listing.js' %}" defer></script>
{% endblock %}
